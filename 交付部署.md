# WebSocketåŠ¨æ€æ•°æ®æ¨¡æ‹Ÿå™¨ - äº¤ä»˜éƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æœ¬åœ°æ„å»º](#æœ¬åœ°æ„å»º)
- [é•œåƒæ‰“åŒ…](#é•œåƒæ‰“åŒ…)
- [é•œåƒä¸Šä¼ ](#é•œåƒä¸Šä¼ )
- [è¿œç¨‹éƒ¨ç½²](#è¿œç¨‹éƒ¨ç½²)
- [å¤šIPéƒ¨ç½²](#å¤šipéƒ¨ç½²)
- [é…ç½®ç®¡ç†](#é…ç½®ç®¡ç†)
- [ç›‘æ§è¿ç»´](#ç›‘æ§è¿ç»´)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

---

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

WebSocketåŠ¨æ€æ•°æ®æ¨¡æ‹Ÿå™¨æ˜¯ä¸€ä¸ªåŸºäºSpring Bootçš„å®æ—¶æ•°æ®æ¨é€æœåŠ¡ï¼Œæ”¯æŒï¼š
- åŠ¨æ€JSONæ¨¡æ¿é…ç½®
- å¤šç§æ•°æ®ç±»å‹ç”Ÿæˆ
- å®æ—¶WebSocketé€šä¿¡
- å¤šIPåœ°å€éƒ¨ç½²
- Dockerå®¹å™¨åŒ–è¿è¡Œ

**æŠ€æœ¯æ ˆ**ï¼š
- Spring Boot 2.7.18
- Java 8
- WebSocket
- Docker
- Maven

---

## ğŸ—ï¸ æœ¬åœ°æ„å»º

> **ç›®å½•è¦æ±‚ï¼šæ‰€æœ‰æœ¬åœ°æ„å»ºæ“ä½œå¿…é¡»åœ¨é¡¹ç›®æ ¹ç›®å½• `kinetic-simulator-WebSocker/` ä¸‹è¿›è¡Œã€‚**
> 
> å¦‚æœä½ åœ¨å…¶ä»–ç›®å½•ï¼Œè¯·å…ˆåˆ‡æ¢åˆ°é¡¹ç›®æ ¹ç›®å½•ï¼š
> ```bash
> cd kinetic-simulator-WebSocker
> ```
> å¦åˆ™è„šæœ¬å’Œ Dockerfile å¯èƒ½æ— æ³•è¢«æ­£ç¡®è¯†åˆ«ï¼Œå¯¼è‡´æ„å»ºå¤±è´¥ã€‚

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿æœ¬åœ°ç¯å¢ƒæ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š
```bash
# æ£€æŸ¥Javaç‰ˆæœ¬
java -version  # éœ€è¦Java 8

# æ£€æŸ¥Dockerç‰ˆæœ¬
docker --version  # éœ€è¦Docker 20.10+

# æ£€æŸ¥Docker Composeç‰ˆæœ¬
docker-compose --version  # éœ€è¦Docker Compose 1.29+
```

### 2. æ„å»ºé•œåƒ

> **æ³¨æ„ï¼šæ— è®ºæ˜¯ä½¿ç”¨è„šæœ¬è¿˜æ˜¯æ‰‹åŠ¨æ„å»ºï¼Œéƒ½å¿…é¡»ä¿è¯å½“å‰ç›®å½•ä¸º `kinetic-simulator-WebSocker/`ã€‚**
> 
> å¦‚æœä½ åˆšåˆšè§£å‹æˆ–æ‹‰å–äº†é¡¹ç›®ï¼Œè¯·åŠ¡å¿…å…ˆè¿›å…¥è¯¥ç›®å½•ã€‚

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
```bash
# Windows
docker-start.bat

# Linux/macOS
./docker-start.sh
```

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ„å»º
```bash
# æ„å»ºé•œåƒ
docker build -t websocket-simulator:latest .

# æˆ–è€…ä½¿ç”¨å¤‡ç”¨Dockerfileï¼ˆå¦‚æœMaven Wrapperæœ‰é—®é¢˜ï¼‰
docker build -f Dockerfile.maven -t websocket-simulator:latest .
```

### 3. éªŒè¯æ„å»ºç»“æœ

```bash
# æŸ¥çœ‹é•œåƒåˆ—è¡¨
docker images | grep websocket-simulator

# æµ‹è¯•è¿è¡Œé•œåƒ
docker run -d -p 1883:1883 --name test-simulator websocket-simulator:latest

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:1883/api/connection-count

# åœæ­¢æµ‹è¯•å®¹å™¨
docker stop test-simulator && docker rm test-simulator
```

---

## ğŸ“¦ é•œåƒæ‰“åŒ…

### 1. é•œåƒæ ‡ç­¾ç®¡ç†

```bash
# ä¸ºé•œåƒæ·»åŠ ç‰ˆæœ¬æ ‡ç­¾
docker tag websocket-simulator:latest websocket-simulator:v1.0.0

# ä¸ºé•œåƒæ·»åŠ ä»“åº“æ ‡ç­¾ï¼ˆå‡†å¤‡ä¸Šä¼ åˆ°ç§æœ‰ä»“åº“ï¼‰
docker tag websocket-simulator:latest your-registry.com/websocket-simulator:v1.0.0
```

### 2. é•œåƒå¯¼å‡º

#### å¯¼å‡ºä¸ºtaræ–‡ä»¶
```bash
# å¯¼å‡ºé•œåƒåˆ°æ–‡ä»¶
docker save -o websocket-simulator-v1.0.0.tar websocket-simulator:v1.0.0

# å‹ç¼©taræ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
gzip websocket-simulator-v1.0.0.tar
```

#### å¯¼å‡ºä¸ºå‹ç¼©åŒ…
```bash
# ä½¿ç”¨gzipå‹ç¼©
docker save websocket-simulator:v1.0.0 | gzip > websocket-simulator-v1.0.0.tar.gz
```

### 3. é•œåƒä¿¡æ¯è®°å½•

åˆ›å»ºé•œåƒä¿¡æ¯æ–‡ä»¶ `image-info.txt`ï¼š
```bash
# ç”Ÿæˆé•œåƒä¿¡æ¯
docker inspect websocket-simulator:v1.0.0 > image-info.txt

# è®°å½•é•œåƒå¤§å°
docker images websocket-simulator:v1.0.0 >> image-info.txt
```

---

## â˜ï¸ é•œåƒä¸Šä¼ 

### 1. ç§æœ‰Dockerä»“åº“

#### é…ç½®Dockerä»“åº“
```bash
# ç™»å½•åˆ°ç§æœ‰ä»“åº“
docker login your-registry.com

# æ¨é€é•œåƒ
docker push your-registry.com/websocket-simulator:v1.0.0
```

#### ä½¿ç”¨Harborä»“åº“
```bash
# ç™»å½•Harbor
docker login harbor.your-company.com

# æ¨é€é•œåƒ
docker tag websocket-simulator:v1.0.0 harbor.your-company.com/project/websocket-simulator:v1.0.0
docker push harbor.your-company.com/project/websocket-simulator:v1.0.0
```

### 2. å…¬å…±Docker Hub

```bash
# ç™»å½•Docker Hub
docker login

# æ¨é€é•œåƒ
docker tag websocket-simulator:v1.0.0 your-username/websocket-simulator:v1.0.0
docker push your-username/websocket-simulator:v1.0.0
```

### 3. é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡

```bash
# ç™»å½•é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡
docker login --username=your-username registry.cn-hangzhou.aliyuncs.com

# æ¨é€é•œåƒ
docker tag websocket-simulator:v1.0.0 registry.cn-hangzhou.aliyuncs.com/your-namespace/websocket-simulator:v1.0.0
docker push registry.cn-hangzhou.aliyuncs.com/your-namespace/websocket-simulator:v1.0.0
```

### 4. è…¾è®¯äº‘å®¹å™¨é•œåƒæœåŠ¡

```bash
# ç™»å½•è…¾è®¯äº‘å®¹å™¨é•œåƒæœåŠ¡
docker login ccr.ccs.tencentyun.com

# æ¨é€é•œåƒ
docker tag websocket-simulator:v1.0.0 ccr.ccs.tencentyun.com/your-namespace/websocket-simulator:v1.0.0
docker push ccr.ccs.tencentyun.com/your-namespace/websocket-simulator:v1.0.0
```

---

## ğŸš€ è¿œç¨‹éƒ¨ç½²

> **ç›®å½•è¦æ±‚ï¼šæ‰€æœ‰è¿œç¨‹éƒ¨ç½²æ“ä½œå¿…é¡»åœ¨æœåŠ¡å™¨çš„ `/opt/websocket-simulator/` ç›®å½•ä¸‹è¿›è¡Œã€‚**
> 
> ä¸Šä¼ çš„é•œåƒåŒ…ã€é…ç½®æ–‡ä»¶ã€docker-compose.yml ç­‰éƒ½åº”æ”¾åœ¨è¯¥ç›®å½•ä¸‹ã€‚
> 
> å¦‚æœä½ åœ¨å…¶ä»–ç›®å½•ï¼Œè¯·å…ˆåˆ‡æ¢åˆ°éƒ¨ç½²ç›®å½•ï¼š
> ```bash
> cd /opt/websocket-simulator
> ```
> å¦åˆ™åç»­çš„è§£å‹ã€å¯åŠ¨ã€é…ç½®ç­‰æ“ä½œå¯èƒ½å¤±è´¥ã€‚

### 1. ç›®æ ‡æœåŠ¡å™¨å‡†å¤‡

#### å®‰è£…Dockerç¯å¢ƒ
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install docker.io docker-compose

# CentOS/RHEL
sudo yum install docker docker-compose

# å¯åŠ¨DockeræœåŠ¡
sudo systemctl start docker
sudo systemctl enable docker

# æ·»åŠ ç”¨æˆ·åˆ°dockerç»„
sudo usermod -aG docker $USER
```

#### åˆ›å»ºéƒ¨ç½²ç›®å½•

> **æ³¨æ„ï¼šå¿…é¡»åœ¨ `/opt/websocket-simulator/` ç›®å½•ä¸‹æ‰§è¡Œåç»­æ‰€æœ‰æ“ä½œã€‚**
```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
sudo mkdir -p /opt/websocket-simulator
sudo chown $USER:$USER /opt/websocket-simulator
cd /opt/websocket-simulator
```

### 2. é•œåƒæ‹‰å–

#### ä»ç§æœ‰ä»“åº“æ‹‰å–
```bash
# ç™»å½•ä»“åº“
docker login your-registry.com

# æ‹‰å–é•œåƒ
docker pull your-registry.com/websocket-simulator:v1.0.0
```

#### ä»taræ–‡ä»¶å¯¼å…¥
```bash
# ä¸Šä¼ taræ–‡ä»¶åˆ°æœåŠ¡å™¨
scp websocket-simulator-v1.0.0.tar user@server:/opt/websocket-simulator/

# å¯¼å…¥é•œåƒ
docker load -i websocket-simulator-v1.0.0.tar
```

### 3. é…ç½®æ–‡ä»¶å‡†å¤‡

> **æ³¨æ„ï¼šè§£å‹ã€å¯¼å…¥é•œåƒã€ç¼–è¾‘é…ç½®ã€å¯åŠ¨æœåŠ¡ç­‰æ“ä½œéƒ½åº”åœ¨ `/opt/websocket-simulator/` ç›®å½•ä¸‹å®Œæˆã€‚**

#### åˆ›å»ºdocker-compose.yml
```yaml
version: '3.8'

services:
  websocket-simulator:
    image: your-registry.com/websocket-simulator:v1.0.0
    container_name: websocket-simulator
    ports:
      - "1883:1883"
    environment:
      - SPRING_PROFILES_ACTIVE=production
      - SERVER_PORT=1883
    volumes:
      - ./logs:/app/logs
      - ./application-production.properties:/app/application-production.properties:ro
    restart: unless-stopped
    networks:
      - websocket-network
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:1883/api/connection-count"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s

networks:
  websocket-network:
    driver: bridge
```

#### åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®
```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶
cat > application-production.properties << EOF
# ç”Ÿäº§ç¯å¢ƒé…ç½®
server.port=1883
server.address=0.0.0.0

# WebSocketé…ç½®
websocket.path=/websocket
websocket.max-connections=200
websocket.heartbeat-interval=30

# æ—¥å¿—é…ç½®
logging.level.com.example.kineticsimulatorwebsocker=INFO
logging.level.org.springframework.web.socket=WARN
logging.file.name=logs/websocket-simulator.log
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# æ•°æ®ç”Ÿæˆé…ç½®
simulator.default-push-interval=5
simulator.max-array-size=1000
simulator.enable-advanced-mode=false

# æ€§èƒ½é…ç½®
spring.task.execution.pool.core-size=4
spring.task.execution.pool.max-size=20
spring.task.execution.pool.queue-capacity=200
EOF
```

### 4. å¯åŠ¨æœåŠ¡

```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p logs

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### 5. éªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:1883/api/connection-count

# æ£€æŸ¥å¥åº·çŠ¶æ€
curl http://localhost:1883/actuator/health

# æµ‹è¯•WebSocketè¿æ¥
wscat -c ws://localhost:1883/websocket
```

---

## ğŸŒ å¤šIPéƒ¨ç½²

> **ç›®å½•è¦æ±‚ï¼šå¤šIPéƒ¨ç½²çš„æ‰€æœ‰æ“ä½œä¹Ÿå¿…é¡»åœ¨æœåŠ¡å™¨çš„ `/opt/websocket-simulator/` ç›®å½•ä¸‹è¿›è¡Œã€‚**
> 
> - `docker-compose-multi-ip.yml`ã€å„IPä¸“ç”¨é…ç½®æ–‡ä»¶ã€æ—¥å¿—ç›®å½•ç­‰éƒ½åº”æ”¾åœ¨è¯¥ç›®å½•ä¸‹ã€‚
> - å¦‚æœä½ åœ¨å…¶ä»–ç›®å½•ï¼Œè¯·å…ˆåˆ‡æ¢åˆ°éƒ¨ç½²ç›®å½•ï¼š
>   ```bash
>   cd /opt/websocket-simulator
>   ```
> - å¦åˆ™å¤šIPæœåŠ¡çš„é…ç½®ã€å¯åŠ¨ã€æ—¥å¿—ç­‰å°†æ— æ³•ç»Ÿä¸€ç®¡ç†ï¼Œå®¹æ˜“å¯¼è‡´æ··ä¹±æˆ–å¤±è´¥ã€‚

### 1. å¤šIPé…ç½®æ–‡ä»¶

#### åˆ›å»ºå¤šIP docker-composeé…ç½®
```yaml
# docker-compose-multi-ip.yml
version: '3.8'

services:
  websocket-simulator-ip1:
    image: your-registry.com/websocket-simulator:v1.0.0
    container_name: websocket-simulator-192.168.2.114
    ports:
      - "1883:1883"
    environment:
      - SPRING_PROFILES_ACTIVE=production
      - SERVER_PORT=1883
      - SERVER_IP=192.168.2.114
    volumes:
      - ./logs/192.168.2.114:/app/logs
      - ./application-192.168.2.114.properties:/app/application-192.168.2.114.properties:ro
    restart: unless-stopped
    networks:
      - websocket-network

  websocket-simulator-ip2:
    image: your-registry.com/websocket-simulator:v1.0.0
    container_name: websocket-simulator-192.168.2.115
    ports:
      - "1885:1883"
    environment:
      - SPRING_PROFILES_ACTIVE=production
      - SERVER_PORT=1883
      - SERVER_IP=192.168.2.115
    volumes:
      - ./logs/192.168.2.115:/app/logs
      - ./application-192.168.2.115.properties:/app/application-192.168.2.115.properties:ro
    restart: unless-stopped
    networks:
      - websocket-network

networks:
  websocket-network:
    driver: bridge
```

#### åˆ›å»ºIPä¸“ç”¨é…ç½®
```bash
# IP1é…ç½®
cat > application-192.168.2.114.properties << EOF
server.port=1883
server.address=192.168.2.114
websocket.path=/websocket
logging.file.name=logs/websocket-simulator-192.168.2.114.log
EOF

# IP2é…ç½®
cat > application-192.168.2.115.properties << EOF
server.port=1883
server.address=192.168.2.115
websocket.path=/websocket
logging.file.name=logs/websocket-simulator-192.168.2.115.log
EOF
```

### 2. å¯åŠ¨å¤šIPæœåŠ¡

> **æ³¨æ„ï¼šæ‰€æœ‰é…ç½®æ–‡ä»¶å’Œæ—¥å¿—ç›®å½•éƒ½åº”åœ¨ `/opt/websocket-simulator/` ä¸‹åˆ›å»ºå’Œç®¡ç†ã€‚**

```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p logs/192.168.2.114 logs/192.168.2.115

# å¯åŠ¨å¤šIPæœåŠ¡
docker-compose -f docker-compose-multi-ip.yml up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose-multi-ip.yml ps
```

> **æ³¨æ„ï¼šå¯åŠ¨å’Œç®¡ç†å¤šIPæœåŠ¡æ—¶ï¼Œå½“å‰ç›®å½•å¿…é¡»ä¸º `/opt/websocket-simulator/`ï¼Œå¦åˆ™ docker-compose å‘½ä»¤ä¼šæ‰¾ä¸åˆ°é…ç½®æ–‡ä»¶ã€‚**

---

## âš™ï¸ é…ç½®ç®¡ç†

### 1. ç¯å¢ƒå˜é‡é…ç½®

#### å¼€å‘ç¯å¢ƒ
```bash
SPRING_PROFILES_ACTIVE=dev
SERVER_PORT=1883
```

#### æµ‹è¯•ç¯å¢ƒ
```bash
SPRING_PROFILES_ACTIVE=test
SERVER_PORT=1883
```

#### ç”Ÿäº§ç¯å¢ƒ
```bash
SPRING_PROFILES_ACTIVE=production
SERVER_PORT=1883
```

### 2. é…ç½®æ–‡ä»¶ç®¡ç†

#### é…ç½®æ–‡ä»¶ç»“æ„
```
config/
â”œâ”€â”€ application-dev.properties      # å¼€å‘ç¯å¢ƒ
â”œâ”€â”€ application-test.properties     # æµ‹è¯•ç¯å¢ƒ
â”œâ”€â”€ application-production.properties # ç”Ÿäº§ç¯å¢ƒ
â”œâ”€â”€ application-192.168.2.114.properties # IP1é…ç½®
â””â”€â”€ application-192.168.2.115.properties # IP2é…ç½®
```

#### é…ç½®çƒ­æ›´æ–°
```bash
# æ›´æ–°é…ç½®æ–‡ä»¶
cp new-config.properties application-production.properties

# é‡å¯æœåŠ¡
docker-compose restart
```

### 3. å¯†é’¥ç®¡ç†

#### ä½¿ç”¨Docker Secrets
```yaml
services:
  websocket-simulator:
    secrets:
      - db_password
      - api_key

secrets:
  db_password:
    file: ./secrets/db_password.txt
  api_key:
    file: ./secrets/api_key.txt
```

---

## ğŸ“Š ç›‘æ§è¿ç»´

### 1. æ—¥å¿—ç®¡ç†

#### æ—¥å¿—æ”¶é›†
```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f websocket-simulator

# å¯¼å‡ºæ—¥å¿—
docker-compose logs > logs.txt
```

#### æ—¥å¿—è½®è½¬
```yaml
services:
  websocket-simulator:
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
```

### 2. å¥åº·æ£€æŸ¥

#### å†…ç½®å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€
curl http://localhost:1883/actuator/health

# æ£€æŸ¥è¿æ¥æ•°
curl http://localhost:1883/api/connection-count
```

#### è‡ªå®šä¹‰ç›‘æ§è„šæœ¬
```bash
#!/bin/bash
# monitor.sh
while true; do
    response=$(curl -s http://localhost:1883/api/connection-count)
    if [ $? -eq 0 ]; then
        echo "$(date): Service is healthy - $response"
    else
        echo "$(date): Service is down!"
        # å‘é€å‘Šè­¦
        docker-compose restart
    fi
    sleep 30
done
```

### 3. æ€§èƒ½ç›‘æ§

#### èµ„æºä½¿ç”¨ç›‘æ§
```bash
# æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨
docker stats websocket-simulator

# æŸ¥çœ‹ç³»ç»Ÿèµ„æº
htop
iostat
```

#### åº”ç”¨æ€§èƒ½ç›‘æ§
```bash
# æŸ¥çœ‹JVMçŠ¶æ€
docker exec websocket-simulator jstat -gc

# æŸ¥çœ‹çº¿ç¨‹çŠ¶æ€
docker exec websocket-simulator jstack
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### 1. å¸¸è§é—®é¢˜

#### ç«¯å£å†²çª
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep 1883

# ä¿®æ”¹ç«¯å£
# ç¼–è¾‘docker-compose.ymlï¼Œå°†1883:1883æ”¹ä¸º1884:1883
```

#### å†…å­˜ä¸è¶³
```bash
# å¢åŠ JVMå†…å­˜
environment:
  - JAVA_OPTS=-Xmx2g -Xms1g
```

#### ç£ç›˜ç©ºé—´ä¸è¶³
```bash
# æ¸…ç†Dockerèµ„æº
docker system prune -a

# æ¸…ç†æ—¥å¿—æ–‡ä»¶
find logs/ -name "*.log" -mtime +7 -delete
```

### 2. æœåŠ¡æ¢å¤

#### è‡ªåŠ¨é‡å¯
```yaml
services:
  websocket-simulator:
    restart: unless-stopped
    deploy:
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
```

#### æ‰‹åŠ¨æ¢å¤
```bash
# åœæ­¢æœåŠ¡
docker-compose down

# æ¸…ç†èµ„æº
docker system prune -f

# é‡æ–°å¯åŠ¨
docker-compose up -d
```

### 3. æ•°æ®å¤‡ä»½

#### é…ç½®æ–‡ä»¶å¤‡ä»½
```bash
# å¤‡ä»½é…ç½®æ–‡ä»¶
tar -czf config-backup-$(date +%Y%m%d).tar.gz *.properties docker-compose*.yml

# æ¢å¤é…ç½®æ–‡ä»¶
tar -xzf config-backup-20241201.tar.gz
```

#### æ—¥å¿—å¤‡ä»½
```bash
# å¤‡ä»½æ—¥å¿—
tar -czf logs-backup-$(date +%Y%m%d).tar.gz logs/

# æ¸…ç†æ—§æ—¥å¿—
find logs/ -name "*.log" -mtime +30 -delete
```

---

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²æ£€æŸ¥æ¸…å•

#### ä¸€ã€éƒ¨ç½²å‰æ£€æŸ¥

##### ç›®æ ‡æœåŠ¡å™¨ Docker ç¯å¢ƒå·²å®‰è£…
- `docker -v`
- `docker-compose -v`
- **è¯´æ˜**ï¼šæ£€æŸ¥ Docker å’Œ Docker Compose æ˜¯å¦å®‰è£…åŠç‰ˆæœ¬ä¿¡æ¯ã€‚

##### ç½‘ç»œè¿æ¥æ­£å¸¸
- `ping <ç›®æ ‡æœåŠ¡å™¨IP>`
- `telnet <ç›®æ ‡æœåŠ¡å™¨IP> 1883`
- **è¯´æ˜**ï¼šä½¿ç”¨ `ping` æµ‹è¯•ç½‘ç»œè¿é€šæ€§ï¼›ä½¿ç”¨ `telnet` æ£€æŸ¥ç›®æ ‡ç«¯å£æ˜¯å¦å¼€æ”¾ä¸”å¯è®¿é—®ã€‚

##### ç«¯å£ 1883 æœªè¢«å ç”¨
- **Linux/macOS**ï¼š`netstat -tulnp | grep 1883`
- **Windows**ï¼š`netstat -ano | findstr 1883`
- **PowerShell**ï¼š`Get-NetTCPConnection -LocalPort 1883`
- **è¯´æ˜**ï¼šæ£€æŸ¥ç«¯å£ 1883 æ˜¯å¦å·²è¢«å…¶ä»–æœåŠ¡å ç”¨ã€‚

##### ç£ç›˜ç©ºé—´å……è¶³
- **Linux/macOS**ï¼š`df -h`
- **PowerShell**ï¼š`Get-Volume`
- **è¯´æ˜**ï¼šæŸ¥çœ‹å¯ç”¨ç£ç›˜ç©ºé—´ï¼Œç¡®ä¿æœ‰è¶³å¤Ÿçš„ç©ºé—´ç”¨äºéƒ¨ç½²ã€‚

##### é•œåƒå·²ä¸Šä¼ åˆ°ä»“åº“
- **åœ¨ä»“åº“æœåŠ¡å™¨ä¸Šæ‰§è¡Œ**ï¼š`docker images`
- `curl -X GET http://<ä»“åº“åœ°å€>:5000/v2/_catalog`
- **è¯´æ˜**ï¼šåˆ—å‡ºæœ¬åœ°é•œåƒï¼Œç¡®è®¤ç›®æ ‡é•œåƒå­˜åœ¨ï¼›é€šè¿‡ `curl` è¯·æ±‚ä»“åº“ç›®å½•ï¼ŒæŸ¥çœ‹é•œåƒæ˜¯å¦æˆåŠŸä¸Šä¼ ã€‚

#### äºŒã€éƒ¨ç½²åéªŒè¯

##### æœåŠ¡æ­£å¸¸å¯åŠ¨
- `docker ps`
- `docker logs <å®¹å™¨ID>`
- **è¯´æ˜**ï¼šæ£€æŸ¥å®¹å™¨æ˜¯å¦å¤„äºè¿è¡ŒçŠ¶æ€å¹¶æŸ¥çœ‹å¯åŠ¨æ—¥å¿—ã€‚

##### ç«¯å£ç›‘å¬æ­£å¸¸
- **Linux/macOS**ï¼š`netstat -tulnp | grep <ç«¯å£å·>`
- **Windows**ï¼š`netstat -ano | findstr <ç«¯å£å·>`
- **PowerShell**ï¼š`Get-NetTCPConnection -LocalPort <ç«¯å£å·>`
- **è¯´æ˜**ï¼šç¡®è®¤æœåŠ¡æ˜¯å¦æ­£å¸¸ç›‘å¬æŒ‡å®šç«¯å£ï¼ˆå¦‚ 1883ï¼‰ã€‚

##### å¥åº·æ£€æŸ¥é€šè¿‡
- **ç¤ºä¾‹**ï¼šå¦‚æœæ˜¯ HTTP æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ `curl -I http://<æœåŠ¡åœ°å€>:<ç«¯å£>/health` æ£€æŸ¥å¥åº·çŠ¶æ€ã€‚
- **è¯´æ˜**ï¼šæŒ‰ç…§æœåŠ¡å®šä¹‰çš„å¥åº·æ£€æŸ¥æ–¹æ³•è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿æœåŠ¡å¤„äºå¥åº·çŠ¶æ€ã€‚

### WebSocket è¿æ¥æ­£å¸¸
- ä½¿ç”¨ ws æµ‹è¯•å·¥å…·ï¼Œå¦‚ `wscat`ï¼š`wscat -c ws://<æœåŠ¡å™¨IP>:<ç«¯å£>`
- **è¯´æ˜**ï¼šä½¿ç”¨ WebSocket å®¢æˆ·ç«¯å·¥å…·æµ‹è¯•è¿æ¥æ˜¯å¦æ­£å¸¸å»ºç«‹ã€‚

##### æ—¥å¿—è¾“å‡ºæ­£å¸¸
- `docker logs -f <å®¹å™¨ID>`
- **è¯´æ˜**ï¼šå®æ—¶æŸ¥çœ‹å®¹å™¨æ—¥å¿—è¾“å‡ºï¼Œç¡®è®¤æ—¥å¿—ä¿¡æ¯æ­£å¸¸ä¸”æ— å…³é”®é”™è¯¯ã€‚

##### é…ç½®æ–‡ä»¶æ­£ç¡®åŠ è½½
- åœ¨æœåŠ¡æ—¥å¿—ä¸­æŸ¥æ‰¾é…ç½®åŠ è½½ç›¸å…³çš„æ—¥å¿—ä¿¡æ¯ï¼Œç¡®è®¤é…ç½®æ–‡ä»¶è·¯å¾„æ­£ç¡®ä¸”å‚æ•°è¢«æ­£ç¡®è¯»å–ã€‚
- **è¯´æ˜**ï¼šæ ¹æ®æ—¥å¿—ä¸­çš„é…ç½®åŠ è½½ä¿¡æ¯éªŒè¯é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®åŠ è½½ã€‚

#### ä¸‰ã€ç«¯å£è¢«å ç”¨æ—¶å¦‚ä½•æ€æ‰å ç”¨è¿›ç¨‹

##### Linux ç³»ç»Ÿ
- **æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹**ï¼š
   - `netstat -tulnp | grep 1883`
   - æˆ–
   - `lsof -i :1883`
   - **è¯´æ˜**ï¼šæŸ¥æ‰¾å ç”¨ç«¯å£ 1883 çš„è¿›ç¨‹ã€‚
- **æ€æ‰å ç”¨è¿›ç¨‹**ï¼š
   - `kill -9 <è¿›ç¨‹ID>`
   - **è¯´æ˜**ï¼šä½¿ç”¨è¿›ç¨‹ ID æ€æ‰å ç”¨ç«¯å£çš„è¿›ç¨‹ã€‚

##### Windows ç³»ç»Ÿ
- **æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹**ï¼š
   - `netstat -ano | findstr 1883`
   - æˆ–
   - `Get-NetTCPConnection -LocalPort 1883`ï¼ˆPowerShellï¼‰
   - **è¯´æ˜**ï¼šæŸ¥æ‰¾å ç”¨ç«¯å£ 1883 çš„è¿›ç¨‹ã€‚
- **æ€æ‰å ç”¨è¿›ç¨‹**ï¼š
   - `taskkill /PID <è¿›ç¨‹ID> /F`
   - **è¯´æ˜**ï¼šä½¿ç”¨è¿›ç¨‹ ID æ€æ‰å ç”¨ç«¯å£çš„è¿›ç¨‹ã€‚

##### è¿ç»´æ£€æŸ¥
- [ ] ç›‘æ§è„šæœ¬æ­£å¸¸è¿è¡Œ
- [ ] æ—¥å¿—è½®è½¬é…ç½®æ­£ç¡®
- [ ] å¤‡ä»½ç­–ç•¥å·²å®æ–½
- [ ] å‘Šè­¦æœºåˆ¶å·²é…ç½®
- [ ] æ–‡æ¡£å·²æ›´æ–°

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è”ç³»æ–¹å¼
- **æŠ€æœ¯æ”¯æŒé‚®ç®±**: 3149878200@qq.com
### å¸¸è§é—®é¢˜FAQ
1. **Q: å¦‚ä½•ä¿®æ”¹æœåŠ¡ç«¯å£ï¼Ÿ**
   A: ä¿®æ”¹docker-compose.ymlä¸­çš„ç«¯å£æ˜ å°„ï¼Œå¦‚"1884:1883"

2. **Q: å¦‚ä½•æŸ¥çœ‹å®æ—¶æ—¥å¿—ï¼Ÿ**
   A: ä½¿ç”¨å‘½ä»¤`docker-compose logs -f`

3. **Q: å¦‚ä½•é‡å¯æœåŠ¡ï¼Ÿ**
   A: ä½¿ç”¨å‘½ä»¤`docker-compose restart`

4. **Q: å¦‚ä½•æ›´æ–°é•œåƒï¼Ÿ**
   A: æ‹‰å–æ–°é•œåƒåä½¿ç”¨`docker-compose up -d`é‡æ–°éƒ¨ç½²

---

## ğŸ“„ ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|----------|
| v1.0.0 | 2024-12-01 | åˆå§‹ç‰ˆæœ¬å‘å¸ƒ |
| v1.1.0 | 2024-12-15 | æ·»åŠ å¤šIPæ”¯æŒ |
| v1.2.0 | 2024-12-30 | ä¼˜åŒ–æ€§èƒ½ç›‘æ§ |

---

*æœ€åæ›´æ–°æ—¶é—´ï¼š2024å¹´12æœˆ* 